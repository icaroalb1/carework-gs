trigger: none

resources:
  pipelines:
    - pipeline: buildapp
      source: icaroalb1.carework-gs
      trigger: true

steps:

  - script: |
      az webapp config container set \
      --name carework \
      --resource-group carework_group-8dd7 \
      --docker-custom-image-name carework.azurecr.io/carework:latest \
      --docker-registry-server-user $(ACR_USER) \
      --docker-registry-server-password $(ACR_PASSWORD)

  - task: AzureWebAppContainer@1
    inputs:
      azureSubscription: 'Azure Guilherme(bd50eca1-c357-4b10-8ba9-44e38ef8c663)'
      appName: 'carework'
      containers: 'carework.azurecr.io/carework:latest'
      # appSettings: |
      #   SPRING_PROFILES_ACTIVE=production
      #   OPENAI_API_KEY=$(OPENAI_API_KEY)
      #   CAREWORK_API_KEY=$(CAREWORK_API_KEY)
      #   CAREWORK_API_BASE_URL=$(CAREWORK_API_BASE_URL)
      #   AZURE_DB_URL=$(AZURE_DB_URL)
      #   AZURE_DB_USER=$(AZURE_DB_USER)
      #   AZURE_DB_PASSWORD=$(AZURE_DB_PASSWORD)




    